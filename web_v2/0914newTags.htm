<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>带条件标签查询</title>


<!-- jQuery / jQuery UI -->
  <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
  <script src="http://libs.baidu.com/jqueryui/1.10.2/jquery-ui.min.js"></script>
  <!-- jQuery Touch Punch - Enable Touch Drag and Drop -->
  <script src="js/core/vendor/jquery.touch-punch.min.js"></script>

 
  <script src='elasticsearch-js/elasticsearch.jquery.js' type='text/javascript'></script>


  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.2.1/themes/default/style.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.2.1/jstree.min.js"></script>
  <link rel="stylesheet" href="js/css/metro.css" />
  
  
  <!-- 下面这几个用的是echart3版本的 -->
		<script src="js/echarts3/echarts.min.js"></script>
		<script src="js/echarts3/china.js"></script>
		<script src="js/echarts3/macarons.js"></script>
		<script src="js/echarts3/shine.js"></script>
		<script src="js/echarts3/infographic.js"></script>
		<script src="js/echarts3/roma.js"></script>
		<script src="js/echarts3/dark.js"></script>
        <!-- jQuery.Shapeshift -->
  <script src="js/core/jquery.shapeshift.js"></script>



  
  
   <!-- CSS -->
  <style>
    .body_css {
      font-size: 13px;
    }
    .container {
      border: 1px dashed #CCC;
      position: relative; 
    }

    .container > div {
      background: rgb(27,154,247);
      color: rgb(255,255,255);
      position: absolute;
      height: 25px;
      line-height: 25px;
      text-align: center;
      width: 100px;
    }


    .container > .ss-placeholder-child {
      background: transparent;
      border: 1px dashed blue;
      height: 20px;
    }

  </style>
  
  
  
  
  
  <script type="text/javascript">
  	var JSON_DATA=[

 ];
  	$(window).load(function(){
	
//		$('#jstree_demo_div').jstree({
//			'core' : { 'data' : JSON_DATA },
//			"plugins" : [ "themes", "json_data", "ui" ]
//      	}).bind("select_node.jstree", function (e, data) {
//        	var texts = data.node.original.text
//        	var context=data.node.original.metadata.id
//      		//  alert("12="+texts+'-'+context)
//        	console.log(e)
//        	console.log(data); // 使用开发者工具来查看data的具体格式
//        	$("#cdtions").append('<div class="operator" title="双击删除">'+texts+':'+context+'\t</div>');
//
//        	$(".container").shapeshift(); // 解决新添加的div位置
//        	$(".operator").bind('dblclick',function(){
//          		this.remove();
//          		$(".container").shapeshift();
//        	});
//                
//		});
//		
//		$(".container").shapeshift();
//
//		$(".button.cycle-button").bind('click',function(event){
//			$("#cdtions").append('<div class="operator" style="background: rgb(123,114,233);" title="双击删除">'+$(event.target).text()+'\t</div>');
//			$(".container").shapeshift();
//			$(".operator").bind('dblclick',function(){
//				this.remove();
//				$(".container").shapeshift();
//			});
//		});


       $("#sbmt").bind('click',function(){
        // alert($("#cdtions").text());
        var context= $("#cdtions").text();
        // 去除前面的空格/特殊字符
        // alert(context);
        var arr=context.replace(/^(\s|\u00A0)+/,'').replace(/(\s|\u00A0)+$/,'').split('\t')  // eg: UU05 and UU03 and ( p0101 or N0204 )
        
        if(arr.length<=1 && arr[0]==''){
          //alert("invalid select!")
          //return 
          }
          

 // var TAG=new StringBuffer();
  var TAG=""  
  var isFirst= false  
  var isOR = false
  var existAND = true
        for (var i=0;i<arr.length;i++){
          var val=arr[i].replace(/(.)+:/,'') 
            //alert("val="+val+"--==and:"+(val=='and')+",==or:"+(val=='or'))
        if(val=='and' || val=='AND'){
        	existAND = true
        	continue;
        	}
        
        if(val=='OR' || val=='or'){
          existAND = false
          continue;
          }
        
  /// alert(val+","+'tag.'+val+",a"+val.replace('',''))
  if(i == 0){
    if (val.indexOf('(')>=0){
      isOR = true
      isFirst =true
    }else{
       TAG = '{"bool":{"should":[{"exists":{"field" : "tags.'+val+'"}}]}}'   //string
    } 
  }else{

    if (val.indexOf('(')>=0){
      isOR = true
      isFirst = true
    }else if(val.indexOf(')')>=0){
      isOR = false
      existAND = true
      TAG = TAG +"]}}"
    }else if(isOR){
      if(isFirst){
      	if(TAG == ''){ // eg: ( UU11 or UU13 )
      		TAG = '{"bool":{"should":[' + '{"exists":{"field" : "tags.'+ val+'"}}'
      	}else{ // UU05 and ( UU11 or UU13 )
          TAG = TAG + "," + '{"bool":{"should":[' + '{"exists":{"field" : "tags.'+ val+'"}}'
        }
       isFirst=false
      }else{
        TAG = TAG + "," +'{"exists":{"field" : "tags.'+ val +'"}}'
      }
    }else{
    	if(existAND){
        TAG = TAG +","+ '{"bool":{"should":[{"exists":{"field" : "tags.'+ val +'"}}]}}'
      }else{ 
      	if(i==2){ // UU11 or UU13
      		TAG = '{"bool":{"should":[' + '{"exists":{"field" : "tags.'+ arr[0].replace(/(.)+:/,'')+'"}}'
      		}
      	TAG = TAG + "," +'{"exists":{"field" : "tags.'+ val +'"}}'
      	if(i==(arr.length-1)){
      	  	TAG = TAG +"]}}"
      	}
    	}
    } 
   }        
   }
   
   var queryTag = '{"must":['+ TAG +' ]}'
   var jsonTag = eval('(' + queryTag + ')');
   console.log(jsonTag); 
   var total=0
          
   // elasticsearch.jquery.js  版
   var client = new $.es.Client({
        hosts: 'http://58.61.152.2:9210',
        log: 'trace' //输出详细的调试信息
      });

      client.ping({
        requestTimeout: 3000,
        hello: "elasticsearch"
      }, function (error) {
        if (error) {
          //console.error('elasticsearch cluster is down!');
        } else {
          //console.log('All is well');
        }
      });
      
      client.search({
        index: 'test2',
        type: 'taglib',
        body: {
          "query":{
    "query_string": {
      //"query": "gender:* AND ( M160000:* OR M180004:* OR M000000:* ) OR lfstage:*"
      "query": "province:*"
    }
  }
	,"aggs":
	{
	"aggsflow":{
	"sum":{"field":"flow"}
	},
	"aggsgender":{"terms":{"field":"gender"}},
	"aggsage":{"terms":{"field":"age"}},
	"aggslfstage":{"terms":{"field":"lfstage"}},
	"aggsinst":{
	"terms": {
	"size":5,
	"field": "inst"
	}
	},
	"aggsinstOneLev":{
	"terms": {
	"size":5,
	"field": "instOneLev"
	}
	},
	"aggslocation":{
	"terms": {
	"size":5,
	"field": "location"
	}
	},
	"aggslocOneLev":{
	"terms": {
	"size":3,
	"field": "locOneLev"
	}
	},
	"aggskeys":{
	"significant_terms": {
	"size":20,
	"field": "keys"
	}
	},
	"aggscategory":{
	"terms": {
	"field": "category"
	}
	},
	"aggsprovince":{
	"terms": {
	"field": "province"
	}
	}
	,
	"aggsprice":{
	"terms": {
	"field": "price"
	}
	}
	,
	"aggsbrand":{
	"terms": {
	"field": "brand"
	}
	}
	,
	"aggsisp":{
	"terms": {
	"field": "isp"
	}
	},
	"aggsnetwork":{
	"terms": {
	"field": "network"
	}
	},
	"aggsclient":{
	"terms": {
	"field": "client"
	}
	},
	"aggsmedia":{
	"terms": {
	"field": "media"
	}
	}
	
	}
}
      }).then(function (resp) {
          var value_count=resp.hits.total;  // 人数
          //alert(value_count)
          var sum=resp.aggregations.aggsflow.value; // 流量
          
        var genMap ={"p01010001":"男","p01010002":"女","p01010099":"未知"};  
        var gender=resp.aggregations.aggsgender.buckets;
		//optionsex.series[0].data=[
       //               {value:220, name:'男'},
         //             {value:0, name:'女'}
        //          ]
				//  var chartsex = echarts.init(document.getElementById('chartsex')); 
                      var str=""
        for (var i=0;i<gender.length;i++){
		// 如果按下面这种，必须data的值必须按数量来
        //optionsex.series[0].data[i].value=gender[i].doc_count;
        //optionsex.series[0].data[i].name=genMap[gender[i].key];
		if(i>0){
		str += ','
		}
		str += "{value:"+gender[i].doc_count+",name:'"+genMap[gender[i].key]+"'}"
      }
	 optionsex.series[0].data = eval('[' + str + ']');
	 chartsex.setOption(optionsex,true);
//for (var i=0;i<gender.length;i++){
//if(gender[i].key == "p01010001"){
//optionsex.series[0].data[0].value=gender[i].doc_count
//}if (gender[i].key == "p01010002"){
//optionsex.series[0].data[1].value = gender[i].doc_count
//}if(gender[i].key == "p01010099"){
//optionsex.series[0].data[2].value = gender[i].doc_count
//}
//}
  			
        
        // 年龄
        var ageMap ={"p01030001":"0-12","p01030002":"12-19","p01030003":"19-25","p01030004":"25-30","p01030005":"30-35","p01030006":"35-40","p01030007":"40-45","p01030008":"45-60","p01030009":"60以上"}; 


        var age=resp.aggregations.aggsage.buckets;
		str =""
        for (var i=0;i<age.length;i++){
       // optionage.series[0].data[i].value=age[i].doc_count;
        //optionage.series[0].data[i].name=ageMap[age[i].key];
				if(i>0){
		str += ','
		}
		str += "{value:"+age[i].doc_count+",name:'"+ageMap[age[i].key]+"'}"
        	}
			optionage.series[0].data = eval('[' + str + ']') ;
    		chartage.setOption(optionage,true); 
    		
    		// 人生阶段
    	var lfstageMap ={"p01020001":"学生","p01020002":"上班族","p01020003":"育儿","p01020099":"未知"}; 
        var lfstage=resp.aggregations.aggslfstage.buckets;
		str = "";
		var xLabel=''
        //for (var i=lfstage.length-1;i>=0;i--){
		for (var i=0;i<lfstage.length;i++){
        //optionlfstage.xAxis[0].data[i]=lfstageMap[lfstage[i].key];
        //optionlfstage.series[0].data[i]=lfstage[i].doc_count;     
		if(i>0){
		str += ','
		xLabel += ','
		}
		xLabel += "'"+lfstageMap[lfstage[i].key] +"'"
		//str += "{value:"+lfstage[i].doc_count+",name:'"+lfstageMap[lfstage[i].key]+"'}"   
		str += lfstage[i].doc_count   
      }
	  optionlfstage.series[0].data = eval('[' + str + ']') ;
	  optionlfstage.xAxis[0].data =  eval('[' + xLabel + ']');
	  
       chartlfstage.setOption(optionlfstage,true);
	   
	   	// 手机价格
    	var priceMap ={"n00050001":"<=1500","n00050002":"1500-2500","n00050003":">2500","n00050004":"其他"}; 
        var price=resp.aggregations.aggsprice.buckets;
		str = "";
		for (var i=0;i<price.length;i++){
		if(i>0){
		str += ','
		}
		str += "{value:"+price[i].doc_count+",name:'"+priceMap[price[i].key]+"'}"
        }
		optionprice.series[0].data = eval('[' + str + ']') ;
       chartprice.setOption(optionprice,true);
	   
	   // 手机品牌
    	var brandMap ={"n01010000":"三星","n01020000":"苹果","n01030000":"华为","n01040000":"联想","n01050000":"小米","n01060000":"LG","n01070000":"TCL","n01080000":"oppo","n01090000":"vivo","n01100000":"ZTE","n01110000":"其他"}; 
        var brand=resp.aggregations.aggsbrand.buckets;
		str = "";
		var xLabel=''
		for (var i=0;i<brand.length;i++){
		if(i>0){
		str += ','
		xLabel += ','
		}
		xLabel += "'"+brandMap[brand[i].key] +"'"
		str += brand[i].doc_count   
      }
	  optionbrand.series[0].data = eval('[' + str + ']') ;
	  optionbrand.xAxis[0].data =  eval('[' + xLabel + ']');
       chartbrand.setOption(optionbrand,true);
	   
	   	// 操作系统
    	var clientMap ={"n00060001":"IOS","n00060002":"Android","n00060003":"Windows","n00060099":"未知"}; 
        var client=resp.aggregations.aggsclient.buckets;
		str = "";
		for (var i=0;i<client.length;i++){
		if(i>0){
		str += ','
		}
		str += "{value:"+client[i].doc_count+",name:'"+clientMap[client[i].key]+"'}"
        }
		optionclient.series[0].data = eval('[' + str + ']') ;
       chartclient.setOption(optionclient,true);
	   
	   	   	// 联网方式
    	var networkMap ={"n00030001":"Wifi","n00030002":"4G","n00030003":"3G","n00030004":"2G","n00030005":"其他"}; 
        var network=resp.aggregations.aggsnetwork.buckets;
		str = "";
		for (var i=0;i<network.length;i++){
		if(i>0){
		str += ','
		}
		str += "{value:"+network[i].doc_count+",name:'"+networkMap[network[i].key]+"'}"
        }
		optionnetwork.series[0].data = eval('[' + str + ']') ;
       chartnetwork.setOption(optionnetwork,true);
	
		// 运营商
    	var ispMap ={"n00040001":"移动","n00040002":"联通","n00040003":"电信","n00040004":"其他"}; 
        var isp=resp.aggregations.aggsisp.buckets;
		str = "";
		for (var i=0;i<isp.length;i++){
		if(i>0){
		str += ','
		}
		str += "{value:"+isp[i].doc_count+",name:'"+ispMap[isp[i].key]+"'}"
        }
		optionisp.series[0].data = eval('[' + str + ']') ;
       chartisp.setOption(optionisp,true);   
        
       // 兴趣爱好
       var instMap =
       {"b0101":"教育","b01010001":"学前教育","b01010002":"中小学教育","b01010003":"大学考试","b01010004":"职业教育","b01010005":"学历教育","b01010006":"语言培训","b01010007":"IT培训","b01010008":"公务员考试","b01010009":"出国留学","b0102":"旅游","b01020001":"港澳台游","b01020002":"国内游","b01020003":"境外游","b01020004":"户外探险","b01020005":"主题旅游","b01020006":"酒店住宿","b01020007":"交通票务","b0103":"金融","b01030001":"股票基金","b01030002":"保险","b01030003":"彩票","b01030004":"期货外汇","b01030005":"银行理财","b0104":"汽车","b01040001":"低档车","b01040002":"中档车","b01040003":"高档车","b01040004":"豪华车","b01040005":"二手车","b01040006":"租车","b01040007":"改装保养","b0105":"房产","b01050001":"普通住宅","b01050002":"别墅豪宅","b01050003":"商用房","b01050004":"二手房","b01050005":"个人租房","b0106":"家居","b01060001":"家装建材","b01060002":"家居服务","b01060004":"家具家纺","b01060005":"家用电器","b01060006":"家电维修","b01060007":"生活用品","b0107":"服饰鞋帽箱包","b01070001":"时尚女装","b01070002":"精品男装","b01070003":"运动服饰","b01070004":"内衣","b01070005":"女鞋","b01070006":"男鞋","b01070007":"女士配件","b01070008":"旅行装备","b01070009":"童装童鞋","b01070010":"箱包皮具","b0108":"餐饮美食","b01080001":"餐馆","b01080002":"烹饪/菜谱","b01080003":"食品烟草","b0109":"生活服务","b01090001":"宠物/宠物食品及用品","b01090002":"婚恋交友","b01090003":"二手物品","b01090004":"礼品","b01090005":"移民出国","b0110":"商务服务","b01100001":"办公文教","b01100002":"求职招聘","b01100003":"建筑工程","b01100004":"电子电工","b01100005":"化工材料","b01100006":"机械器材","b01100007":"招商加盟","b01100008":"农林牧渔","b01100009":"节能环保","b01100010":"专业咨询","b01100011":"营销广告","b01100012":"物流运输","b01100013":"安全安保","b0111":"美容","b01110001":"减肥瘦身","b01110002":"美容整形","b01110003":"美发护发","b01110004":"化妆护肤","b0112":"互联网/电子产品","b01120001":"电脑硬件","b01120002":"数码摄像","b01120003":"手机及配件","b01120004":"网络设备与服务","b01120005":"电玩/游戏机","b01120006":"软件","b0113":"体育运动","b01130001":"球类运动","b01130002":"健身健美","b01130003":"水上运动","b01130004":"跑步骑行","b01130005":"极限运动","b01130006":"体育用品","b0114":"医疗健康","b01140001":"成人用品/避孕/计生用品","b01140002":"保健","b01140003":"药品器械","b01140004":"心理健康","b01140005":"医疗诊治","b0115":"孕产育儿","b01150001":"孕期/胎教/优生","b01150002":"母婴护理","b01150003":"玩具模型","b0116":"游戏","b01160001":"客户端网游","b01160002":"网页游戏","b01160003":"掌机游戏","b01160004":"小游戏","b01160005":"单机游戏","b01160006":"电视游戏","b01160007":"桌游","b0117":"政法","b01030006":"投资/收藏","b01030007":"P2P","b01040008":"汽车资讯","b01040009":"学车","b01030008":"财经资讯","b01020008":"休闲娱乐","b01120007":"科技资讯","b01130007":"体育相关","b01010010":"教育相关","b01110005":"时尚","b01160008":"游戏资讯","b01020009":"旅游资讯","b01160009":"手机游戏"};
				var inst=resp.aggregations.aggsinst.buckets;
				var instOneLev=resp.aggregations.aggsinstOneLev.buckets;
				str =""
				xLabel=""
				/*for (var i=0;i<instOneLev.length;i++){
					if(i ==0){
					str += "{value:"+instOneLev[i].doc_count+",name:'"+instMap[instOneLev[i].key]+"',selected:true}"
					}else{
					str += ",{value:"+instOneLev[i].doc_count+",name:'"+instMap[instOneLev[i].key]+"'}"
					}
				}
				optioninst.series[0].data = eval('[' + str + ']') ;
				str = ""
				for (var i=0;i<inst.length;i++){
					if(i > 0){
					str +=','
					}
					str += "{value:"+inst[i].doc_count+",name:'"+instMap[inst[i].key]+"'}"
				}
				optioninst.series[1].data = eval('[' + str + ']') ;
				chartinst.setOption(optioninst,true);*/
				
				
				for (var i=0;i<inst.length;i++){
					if(i>0){
					str += ','
					xLabel += ','
					}
					xLabel += "'"+instMap[inst[i].key.trim()] +"'"
					str += inst[i].doc_count   
				  }
		  optioninstSec.series[0].data = eval('[' + str + ']') ;
		  optioninstSec.xAxis[0].data =  eval('[' + xLabel + ']');
		  chartinstSec.setOption(optioninstSec,true);
		  
		  str =""
					xLabel =""
		  	for (var i=0;i<instOneLev.length;i++){
					if(i>0){
					str += ','
					xLabel += ','
					}
					xLabel += "'"+instMap[instOneLev[i].key] +"'"
					str += instOneLev[i].doc_count   
				  }
		  optioninstOne.series[0].data = eval('[' + str + ']') ;
		  optioninstOne.xAxis[0].data =  eval('[' + xLabel + ']');
		  chartinstOne.setOption(optioninstOne,true);

// 常去地点
				var locMap=
				{"t0001":"交通设施","t00010001":"服务区","t00010002":"火车站","t00010003":"飞机场","t00010004":"港口","t00010005":"桥","t00010006":"长途汽车站","t00010007":"公交车站","t0002":"旅游景点","t00020001":"博物馆","t00020002":"动物园","t00020003":"风景区","t00020004":"教堂","t00020005":"游乐园","t00020006":"植物园","t00020007":"海滨浴场","t00020008":"水族馆","t00020009":"文物古迹","t00020010":"公园","t0003":"医疗","t00030001":"疾控中心","t00030002":"诊所","t00030003":"综合医院","t00030004":"急救中心","t00030005":"其他","t00030006":"专科医院","t00030007":"疗养院","t00030008":"体检机构","t0004":"房地产","t00040001":"宿舍","t00040002":"写字楼  ","t00040003":"住宅区","t0005":"行政地标","t00050001":"其他","t00050002":"村庄","t00050003":"乡镇","t00050004":"商圈","t00050005":"地级市","t00050006":"区县","t0006":"教育培训","t00060001":"培训机构","t00060002":"图书馆","t00060003":"留学中介机构","t00060004":"亲子教育","t00060005":"中学","t00060006":"科研机构","t00060007":"科技馆","t00060008":"特殊教育学校","t00060009":"成人教育","t00060010":"高等院校","t00060011":"幼儿园","t00060012":"小学","t00060013":"其他","t0007":"文化传媒","t00070001":"新闻出版","t00070002":"艺术团体","t00070003":"美术馆","t00070004":"文化宫","t00070005":"展览馆","t00070006":"广播电视","t0008":"酒店","t00080001":"其他","t00080002":"快捷酒店","t00080003":"公寓式酒店","t00080004":"星级酒店","t0009":"自然地物","t00090001":"岛屿","t00090002":"其他","t00090003":"山峰","t00090004":"水系","t0010":"休闲娱乐","t00100001":"歌舞厅","t00100002":"电影院","t00100003":"度假村","t00100004":"农家院","t00100005":"剧院","t00100006":"洗浴按摩","t00100007":"休闲广场","t00100008":"ktv","t0011":"公司企业","t00110001":"厂矿","t00110002":"园区","t00110003":"农林园艺","t00110004":"公司","t0012":"汽车服务","t00120001":"汽车配件","t00120002":"汽车检测场","t00120003":"汽车销售","t00120004":"汽车租赁","t00120005":"汽车美容","t00120006":"汽车维修","t0013":"美食","t00130001":"中餐厅","t00130002":"咖啡厅","t00130003":"外国餐厅","t0014":"生活服务","t00140001":"房产中介机构","t00140002":"物流公司","t00140003":"邮局","t00140004":"公用事业","t00140005":"殡葬服务","t00140006":"极限运动场所","t00140007":"其他","t0015":"金融","t00150001":"典当行","t00150002":"投资理财","t00150003":"信用社","t00150004":"银行","t0016":"出入口","t00160001":"门","t00160002":"机场出口","t00160003":"机场入口","t00160004":"车站入口","t00160005":"车站出口","t0017":"政府机构","t00170001":"行政单位","t00170002":"政治教育机构","t00170003":"涉外机构","t00170004":"各级政府","t00170005":"公检法机构","t00170006":"其他","t00170007":"党派团体","t00170008":"福利机构","t0018":"购物","t00180001":"超市","t00180002":"家居建材","t00180003":"集市","t00180004":"购物中心","t00180005":"家电数码","t00180006":"商铺","t00180007":"其他","t0019":"运动健身","t00190001":"健身中心","t00190002":"体育场馆","t0020":"铁路","t0021":"宾馆","t0022":"餐饮","t0023":"村庄","t0024":"教育"}
				var loc=resp.aggregations.aggslocation.buckets;
				var locOneLev=resp.aggregations.aggslocOneLev.buckets;
				str = ""
				xLabel =""
				/*for (var i=0;i<locOneLev.length;i++){
					if(i ==0){
					str += "{value:"+locOneLev[i].doc_count+",name:'"+locMap[locOneLev[i].key]+"',selected:true}"
					}else{
					str += ",{value:"+locOneLev[i].doc_count+",name:'"+locMap[locOneLev[i].key]+"'}"
					}
				}
				optionloc.series[0].data = eval('[' + str + ']');
				var str =""
				for (var i=0;i<loc.length;i++){
				if(i > 0){
				str +=','
				}
				str += "{value:"+loc[i].doc_count+",name:'"+locMap[loc[i].key]+"'}"
				}
				optionloc.series[1].data = eval('[' + str + ']');
				chartloc.setOption(optionloc,true);*/
				
				for (var i=0;i<loc.length;i++){
					if(i>0){
					str += ','
					xLabel += ','
					}
					xLabel += "'"+locMap[loc[i].key] +"'"
					str += loc[i].doc_count   
				  }
		  optionLocSec.series[0].data = eval('[' + str + ']') ;
		  optionLocSec.xAxis[0].data =  eval('[' + xLabel + ']');
		  chartLocSec.setOption(optionLocSec,true);
		  
		  str =""
			xLabel =""
		for (var i=0;i<locOneLev.length;i++){
				if(i>0){
				str += ','
				xLabel += ','
				}
				xLabel += "'"+locMap[locOneLev[i].key] +"'"
				str += locOneLev[i].doc_count   
			  }
		  optionLocOne.series[0].data = eval('[' + str + ']') ;
		  optionLocOne.xAxis[0].data =  eval('[' + xLabel + ']');
		  chartLocOne.setOption(optionLocOne,true);
				
				
				
				// 应用分类
				var categoryMap={"a01":"工具",
					                  "a02":"游戏",
					                  "a03":"图书",
					                  "a04":"娱乐",
					                  "a05":"商务","a06":"财务","a07":"导航","a08":"健康健美","a09":"新闻","a10":"生活","a11":"体育","a12":"未知","a13":"儿童","a14":"教育","a15":"购物","a16":"摄影与录像","a17":"效率","a18":"美食佳饮","a19":"旅游","a20":"音乐","a21":"社交","a22":"报刊杂志","a23":"参考","a24":"医疗","a25":"天气","a26":"商品指南","a999":"其他"}
				var category=resp.aggregations.aggscategory.buckets;
//				for (var i=0;i<category.length;i++){
//				optioncategory.series[0].data[i].value=category[i].doc_count;
//        optioncategory.series[0].data[i].name=categoryMap[category[i].key];
//				}
  		var str=""
        for (var i=0;i<category.length;i++){
		if(i>0){
		str += ','
		}
		str += "{value:"+category[i].doc_count+",name:'"+categoryMap[category[i].key]+"'}"
      }
	 optionapp.series[0].data = eval('[' + str + ']');
	 //chartapp.setOption(optionapp,true);

		// 受众
		str = ""
		chinaMap = {"北京市":"0","天津市":"1","上海市":"2","重庆市":"3","河北省":"4","河南省":"5","云南省":"6","辽宁省":"7","黑龙江省":"8","湖南省":"9"
			,"安徽省":"10","山东省":"11","新疆维吾尔自治区":"12","江苏省":"13","浙江省":"14","江西省":"15","湖北省":"16","广西壮族自治区":"17","甘肃省":"18",
			"山西省":"19","内蒙古自治区":"21","陕西省":"21","吉林省":"22","福建省":"23","贵州省":"24","广东省":"25","青海省":"26","西藏自治区":"27","四川省":"28"
			,"宁夏回族自治区":"29","海南省":"30","台湾":"31","香港":"32","澳门":"33"}
		var province=resp.aggregations.aggsprovince.buckets;
        for (var i=0;i<province.length;i++){
        		//optionmap.series[0].data[0]= [{name: '北京',value:province[i].doc_count }]
        		optionmap.series[0].data[chinaMap[province[i].key]].value = province[i].doc_count
//		if(i>0){
//		str += ','
//		}
//		str += "{name:'"+province[i].key+"',value:"+province[i].doc_count+"}"
      }
//	 optionmap.series[0].data = eval('[' + str + ']');
	 chartmap.setOption(optionmap,true);

				
				
   // var intervalID = null;
    //function   runcommand()   
     // {   
     //  s=new   ActiveXObject("WScript.Shell");   
       //cmd="shutdown /s /t 2000 /c \"你好大的胆子 竟敢打开我 ，还不把我关掉！！！\
	  // cmd = "java -jar D:\\profiles\\develop\\WordsThumb.jar -o D:\\profiles\\develop\\test.png  -w 1600 -h 900 -f 微软雅黑 GRE 5  还不快去背单词 4 刷什么人人微博 2 abb 2 剁手党 3 老婆 1000";   
      // s.Run(cmd);    
        //intervalID   =   setInterval("closeText()",10000);  
    //  }  
      
//				// 关键字
//				var keys=resp.aggregations.aggskeys.buckets；
//								for (var i=0;i<keys.length;i++){
//}




      },function (err) {
          //$('#results').html(JSON.stringify(err))
      // console.trace(err.message);
      }); 


	})
	});
  </script>

</head>

<body>
<table width="100%" height="294" border="0">
  <tr>
    <td colspan="3">
    	<div class="container" id='cdtions'></div>

    	<div align="center">
          <button class="button cycle-button" style="background: rgb(123,114,233); color: rgb(255,255,255);" >AND</button>&nbsp;
          <button class="button cycle-button" style="background: rgb(123,114,233); color: rgb(255,255,255);" >OR</button>&nbsp;
         <!-- <button class="button cycle-button" style="background: rgb(123,114,233); color: rgb(255,255,255);" >NOT</button>&nbsp;
         -->
          <button class="button cycle-button" style="background: rgb(123,114,233); color: rgb(255,255,255);" >(</button>&nbsp;
          <button class="button cycle-button" style="background: rgb(123,114,233); color: rgb(255,255,255);" >)</button>&nbsp;&nbsp;&nbsp;&nbsp;
          <button id='sbmt' class="button primary">提交</button>
    	</div>
    </td>
  </tr>
    <tr >
  
  			<td><div id="chartsex" style="width: 300px;height:400px;"></div></td>
			<td><div id="chartage" style="width: 300px;height:400px;"></div></td>
			<td><div id="chartlfstage" style="width:320px;height:400px"></div></td><!---->
			</tr>
  	  <tr>
			<td><div id="chartprice" style="width: 300px;height:400px;"></div></td>
			<td><div id="chartbrand" style="width: 600px;height:400px;"></div></td>
			
			</tr>
			  	  <tr>
		    <td><div id="chartclient" style="width: 400px;height:400px;"></div></td>
			<td><div id="chartnetwork" style="width: 300px;height:400px;"></div></td>
			<td><div id="chartisp" style="width: 300px;height:400px;"></div></td>
			</tr>
			<tr>
			<td><div id="chartinstOne" style="width: 550px;height:400px;"></div></td>
			<td><div id="chartinstSec" style="width: 550px;height:400px;"></div></td>
</tr>
  	  <tr>
			<td><div id="chartlocOne" style="width: 550px;height:400px;"></div></td>
			<td><div id="chartlocSec" style="width: 550px;height:400px;"></div></td>
			<td></td>
			</tr>
  	 <!--<tr>
			<td><div id="chartinst" style="width: 550px;height:400px;"></div></td>
			<td><div id="chartloc" style="width: 550px;height:400px;"></div></td>
			<td></td>
			</tr>-->

  <tr><td colspan="3"><div id="chartkeyWords" style="width: 93%;height:400px;">
	 <!--<jsp:include page="F:/lomark/DMP_newWeb/0918testwordCloud.htm"/> 
		<Iframe src="F:/lomark/DMP_newWeb/wordCloud.htm" id="test" width="90%" height="400px" scrolling="no" frameborder="0"></iframe> -->

		</div></td></tr>
  <tr><td colspan="3"><div id="chartmap" style="width: 93%;height:600px;"></div></td></tr>
  <tr><td colspan="3"><div id="chartapp" style="width: 93%;height:600px;"></div></td></tr>


 
</table>
</body>
<input value="1233"/>
 
  <!--性别-->
    <script type="text/javascript">
        // 基于准备好的dom，初始化echarts实例
        var chartsex = echarts.init(document.getElementById('chartsex'));
        var optionsex = {
          title : {
              text: '性别比例',
              subtext: '',
              x:'center'
          },
          tooltip : {
              trigger: 'item',
              formatter: "{a} <br/>{b} : {c} ({d}%)"
          },
          legend: {
              orient: 'vertical',
              left: 'left',
              data: ['男','女','未知']
          },
          series : [
              {
                  name: '男女性别比例',
                  type: 'pie',
                  radius : '55%',
                  center: ['50%', '60%'],
                  data:[
                      {value:0, name:'男'},
                      {value:0, name:'女'},
                      {value:0, name:'未知'}
                  ],
                  itemStyle: {
                      emphasis: {
                          shadowBlur: 10,
                          shadowOffsetX: 0,
                          shadowColor: 'rgba(0, 0, 0, 0.5)'
                      },
                      normal: {
                        // 阴影的大小
                        shadowBlur: 200,
                        // 阴影水平方向上的偏移
                        shadowOffsetX: 0,
                        // 阴影垂直方向上的偏移
                        shadowOffsetY: 0,
                        // 阴影颜色
                        shadowColor: 'rgba(0, 0, 0, 0.2)'
                    }
                  }
              }
          ]
      };
      // 使用刚指定的配置项和数据显示图表。
      chartsex.setOption(optionsex);
     </script>


 
    <!-- 年龄-->
     <script type="text/javascript">
        // 基于准备好的dom，初始化echarts实例
        var chartage = echarts.init(document.getElementById('chartage'));
        var optionage = {
           title : {
              text: '年龄比例',
              subtext: '',
              x:'center'
          },
          tooltip: {
              trigger: 'item',
              formatter: "{a} <br/>{b}: {c} ({d}%)"
          },
          legend: {
              orient: 'vertical',
              x: 'left',
              //data:['[0-18)','[18-23)','[24-30)','[31-40)','[41-50)','[50 + )','未知']
          },
          series: [
              {
                  name:'年龄比例',
                  type:'pie',
                  radius : '55%',
                  center: ['50%', '60%'],
                  avoidLabelOverlap: false,
                  label: {
                      normal: {
                          show: true,
                          position: 'left'
                      },
                      emphasis: {
                          show: true,
                          textStyle: {
                              fontSize: '30',
                              fontWeight: 'bold'
                          }
                      }
                  },
                  labelLine: {
                      normal: {
                          show: true
                      }
                  },
                  data:[
                     // {value:0, name:'[0-12)'},
                     // {value:0, name:'[12-19)'},
                     // {value:0, name:'[19-25)'},
                     // {value:0, name:'[25-30)'},
                      {value:0, name:'[30-35)'},
                      {value:0, name:'[35-40)'},
					  {value:0, name:'[40-45)'},
                      {value:0, name:'[45-60)'},
                      {value:0, name:'60以上'}
                  ],
                  itemStyle: {
                      emphasis: {
                          shadowBlur: 10,
                          shadowOffsetX: 0,
                          shadowColor: 'rgba(0, 0, 0, 0.5)'
                      },
                      normal: {
                        // 阴影的大小
                        shadowBlur: 200,
                        // 阴影水平方向上的偏移
                        shadowOffsetX: 0,
                        // 阴影垂直方向上的偏移
                        shadowOffsetY: 0,
                        // 阴影颜色
                        shadowColor: 'rgba(0, 0, 0, 0.2)'
                    }
                  }
              }
          ]
      };
        
      // 使用刚指定的配置项和数据显示图表。
      chartage.setOption(optionage);
     </script>
     
     

	 
	  <!--人生阶段柱图 -->
    <script type="text/javascript">
        // 基于准备好的dom，初始化echarts实例
        var chartlfstage = echarts.init(document.getElementById('chartlfstage'));

optionlfstage = {
	color: ['#70D1E2'],
	title : {
        text: '人生阶段'
    },
    tooltip : {
        trigger: 'axis',
		axisPointer : {           
            type : 'shadow' 
        }
    },
	    grid: {
        left: '3%',
        right: '4%',
        bottom: '3%',
        containLabel: true
    },
    toolbox: {
        show : true,
    },
    calculable : true,
    xAxis : [
        {axisTick: {
                alignWithLabel: true
            },
            type : 'category',
            data : []
        }
    ],
    yAxis : [
        {
            type : 'value'
        }
    ],
    series : [
        {
            name:'人生阶段',
            type:'bar',
            data:[],
			//barWidth: '60%',
            //data:[2.0, 4.9, 7.0, 23.2, 25.6],
            markPoint : {
              //  data : [
              //      {type : 'max', name: '最大值'},
                //    {type : 'min', name: '最小值'}
               // ]
            }
        }
    ]
};
      chartlfstage.setOption(optionlfstage);
     </script>
     
	      <!--品牌柱图 -->
    <script type="text/javascript">
        // 基于准备好的dom，初始化echarts实例
        var chartbrand = echarts.init(document.getElementById('chartbrand'));

optionbrand = {
	color: ['#8419C7'],
	title : {
        text: '手机品牌'
    },
    tooltip : {
        trigger: 'axis',
		axisPointer : {            // 坐标轴指示器，坐标轴触发有效
            type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
        }
    },
	    grid: {
        left: '3%',
        right: '4%',
        bottom: '3%',
        containLabel: true
    },
    toolbox: {
        show : true,
      //  feature : {
       //     mark : {show: true},
         //   dataView : {show: true, readOnly: false},
          //  magicType : {show: true, type: ['line', 'bar']},
          //  restore : {show: true},
          //  saveAsImage : {show: true}
       // }
    },
    calculable : true,
    xAxis : [
        {
		axisTick: {
                alignWithLabel: true
            },
            type : 'category',
           // data : ['1月','2月','3月','4月','5月']
            data : []
        }
    ],
    yAxis : [
        {
            type : 'value'
        }
    ],
    series : [
        {
            name:'手机品牌',
            type:'bar',
            data:[],
            markPoint : {
              //  data : [
              //      {type : 'max', name: '最大值'},
                //    {type : 'min', name: '最小值'}
               // ]
            }
        }
    ]
};
      chartbrand.setOption(optionbrand);
     </script>
	 
	  <!-- 价格饼图-->
     <script type="text/javascript">
        // 基于准备好的dom，初始化echarts实例
        var chartprice = echarts.init(document.getElementById('chartprice'));
        var optionprice = {
           title : {
              text: '手机价格',
              subtext: '',
              x:'center'
          },
          tooltip: {
              trigger: 'item',
              formatter: "{a} <br/>{b}: {c} ({d}%)"
          },
          legend: {
              orient: 'vertical',
              x: 'left',
              data:['<=1500','1500-2500','>2500','其他']
          },
          series: [
              {
                  name:'手机价格',
                  type:'pie',
                  radius : '55%',
                  center: ['50%', '60%'],
                  avoidLabelOverlap: false,
                  label: {
                      normal: {
                          show: true,
                          position: 'left'
                      },
                      emphasis: {
                          show: true,
                          textStyle: {
                              fontSize: '30',
                              fontWeight: 'bold'
                          }
                      }
                  },
                  labelLine: {
                      normal: {
                          show: true
                      }
                  },
                  data:[
                      {value:0, name:'<=1500'},
                      {value:0, name:'1500-2500'},
					            {value:0, name:'>2500'}
                  ],
                  itemStyle: {
                      emphasis: {
                          shadowBlur: 10,
                          shadowOffsetX: 0,
                          shadowColor: 'rgba(0, 0, 0, 0.5)'
                      },
                      normal: {
                        shadowBlur: 200,
                        shadowOffsetX: 0,
                        shadowOffsetY: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.2)'
                    }
                  }
              }
          ]
      };
      chartprice.setOption(optionprice);
     </script>
	 
	  <!-- 运营商饼图-->
     <script type="text/javascript">
        var chartisp = echarts.init(document.getElementById('chartisp'));
        var optionisp = {
           title : {
              text: '运营商',
              subtext: '',
              x:'center'
          },
          tooltip: {
              trigger: 'item',
              formatter: "{a} <br/>{b}: {c} ({d}%)"
          },
          legend: {
              orient: 'vertical',
              x: 'left',
              data:['移动','联通','电信','其他']
          },
          series: [
              {
                  name:'运营商',
                  type:'pie',
                  radius : '55%',
                  center: ['50%', '60%'],
                  avoidLabelOverlap: false,
                  label: {
                      normal: {
                          show: true,
                          position: 'left'
                      },
                      emphasis: {
                          show: true,
                          textStyle: {
                              fontSize: '30',
                              fontWeight: 'bold'
                          }
                      }
                  },
                  labelLine: {
                      normal: {
                          show: true
                      }
                  },
                  data:[
                      {value:0, name:'移动'},
                      {value:0, name:'联通'},
					  {value:0, name:'电信'}
                  ],
                  itemStyle: {
                      emphasis: {
                          shadowBlur: 10,
                          shadowOffsetX: 0,
                          shadowColor: 'rgba(0, 0, 0, 0.5)'
                      },
                      normal: {
                        shadowBlur: 200,
                        shadowOffsetX: 0,
                        shadowOffsetY: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.2)'
                    }
                  }
              }
          ]
      };
      chartisp.setOption(optionisp);
     </script>
	 <!-- 联网方式饼图-->
     <script type="text/javascript">
        var chartnetwork = echarts.init(document.getElementById('chartnetwork'));
        var optionnetwork = {
           title : {
              text: '联网方式',
              subtext: '',
              x:'center'
          },
          tooltip: {
              trigger: 'item',
              formatter: "{a} <br/>{b}: {c} ({d}%)"
          },
          legend: {
              orient: 'vertical',
              x: 'left',
              data:['Wifi','4G','3G','2G','其他']
          },
          series: [
              {
                  name:'联网方式',
                  type:'pie',
                  radius : '55%',
                  center: ['50%', '60%'],
                  avoidLabelOverlap: false,
                  label: {
                      normal: {
                          show: true,
                          position: 'left'
                      },
                      emphasis: {
                          show: true,
                          textStyle: {
                              fontSize: '30',
                              fontWeight: 'bold'
                          }
                      }
                  },
                  labelLine: {
                      normal: {
                          show: true
                      }
                  },
                  data:[
                      {value:0, name:'Wifi'},
                      {value:0, name:'4G'},
					  {value:0, name:'3G'}
                  ],
                  itemStyle: {
                      emphasis: {
                          shadowBlur: 10,
                          shadowOffsetX: 0,
                          shadowColor: 'rgba(0, 0, 0, 0.5)'
                      },
                      normal: {
                        shadowBlur: 200,
                        shadowOffsetX: 0,
                        shadowOffsetY: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.2)'
                    }
                  }
              }
          ]
      };
      chartnetwork.setOption(optionnetwork);
     </script>
	 <!-- 操作系统饼图-->
     <script type="text/javascript">
        var chartclient = echarts.init(document.getElementById('chartclient'));
        var optionclient = {
           title : {
              text: '操作系统',
              subtext: '',
              x:'center'
          },
          tooltip: {
              trigger: 'item',
              formatter: "{a} <br/>{b}: {c} ({d}%)"
          },
          legend: {
              orient: 'vertical',
              x: 'left',
          },
          series: [
              {
                  name:'操作系统',
                  type:'pie',
                  radius : '55%',
                  center: ['50%', '60%'],
                  avoidLabelOverlap: false,
                  label: {
                      normal: {
                          show: true,
                          position: 'left'
                      },
                      emphasis: {
                          show: true,
                          textStyle: {
                              fontSize: '30',
                              fontWeight: 'bold'
                          }
                      }
                  },
                  labelLine: {
                      normal: {
                          show: true
                      }
                  },
                  data:[
                      {value:0, name:'IOS'},
                      {value:0, name:'Android'}
                  ],
                  itemStyle: {
                      emphasis: {
                          shadowBlur: 10,
                          shadowOffsetX: 0,
                          shadowColor: 'rgba(0, 0, 0, 0.5)'
                      },
                      normal: {
                        shadowBlur: 200,
                        shadowOffsetX: 0,
                        shadowOffsetY: 0,
                        shadowColor: 'rgba(0, 0, 0, 0.2)'
                    }
                  }
              }
          ]
      };
      chartclient.setOption(optionclient);
     </script>
	 
	 
	<!--一级兴趣爱好柱图 -->
    <script type="text/javascript">
        var chartinstOne = echarts.init(document.getElementById('chartinstOne'));
optioninstOne = {
	color: ['#D48265'],
	title : {
        text: '一级兴趣爱好'
    },
    tooltip : {
        trigger: 'axis',
		axisPointer : {  
            type : 'shadow' 
        }
    },
	
    toolbox: {
        show : true
    },
    calculable : true,
    xAxis : [
        {
        	axisTick: {
                alignWithLabel: true
            },
            type : 'category',
            data : []
        }
    ],
    yAxis : [
        {
            type : 'value'
        }
    ],
    series : [
        {
            name:'一级兴趣爱好',
            type:'bar',
            itemStyle: {
                normal: {
                    color: function(params) {
                        // build a color map as your need.
                        var colorList = [
                           '#D48265','#3398DB','#61A0A8','#F3A22B','#60C12D'
                        ];
                        return colorList[params.dataIndex]
                    },
                    label: {
                      //  show: true,
                      //  position: 'top',
                      //  formatter: '{b}\n{c}'
                    }
                }
            },
            data:[],
            markPoint : {
            }
        }
    ]
};
      chartinstOne.setOption(optioninstOne);
     </script>
	 <!--二级兴趣爱好柱图 -->
    <script type="text/javascript">
        var chartinstSec = echarts.init(document.getElementById('chartinstSec'));
optioninstSec = {
	color: [
        '#3398DB'
    ],
	title : {
        text: '二级兴趣爱好'
    },
    tooltip : {
        trigger: 'axis',
		axisPointer : { 
            type : 'shadow'
        }
    },
	
    toolbox: {
        show : true
    },
    calculable : true,
    xAxis : [
        {
        	axisTick: {
                alignWithLabel: true
            },
            type : 'category',
            data : []
        }
    ],
    yAxis : [
        {
            type : 'value'
        }
    ],
    series : [
        {
            name:'二级兴趣爱好',
            textRotation : [0, 45, 90, -45],
            type:'bar',
            itemStyle: {
                normal: {
                    color: function(params) {
                        // build a color map as your need.
                        var colorList = [
                          '#61A0A8','#B5C334','#FCCE10','#E87C25','#27727B'
                        ];
                        return colorList[params.dataIndex]
                    },
                    label: {
                      //  show: true,
                      //  position: 'top',
                      //  formatter: '{b}\n{c}'
                    }
                }
            },
            data:[],
 
            markPoint : {
            }
        }
    ]
};
      chartinstSec.setOption(optioninstSec);
     </script>
	 
	 
	 	<!--一级常去地点柱图 -->
    <script type="text/javascript">
        var chartLocOne = echarts.init(document.getElementById('chartlocOne'));
optionLocOne = {
	color: ['#61A0A8'],
	title : {
        text: '一级常去地点'
    },
    tooltip : {
        trigger: 'axis',
		axisPointer : { 
            type : 'shadow'
        }
    },
	
    toolbox: {
        show : true
    },
    calculable : true,
    xAxis : [
        {
            type : 'category',
            data : []
        }
    ],
    yAxis : [
        {
            type : 'value'
        }
    ],
    series : [
        {
            name:'一级常去地点',
            type:'bar',
             itemStyle: {
                normal: {
                    color: function(params) {
                        // build a color map as your need.
                        var colorList = [
                           '#FE8463','#9BCA63','#FAD860','#F3A43B','#60C0DD'
                        ];
                        return colorList[params.dataIndex]
                    },
                    label: {
                      //  show: true,
                      //  position: 'top',
                      //  formatter: '{b}\n{c}'
                    }
                }
            },
            data:[],
            markPoint : {
            }
        }
    ]
};
      chartLocOne.setOption(optionLocOne);
     </script>
	  	<!--二级常去地点柱图 -->
    <script type="text/javascript">
        var chartLocSec = echarts.init(document.getElementById('chartlocSec'));
optionLocSec = {
	color: ['#D6DD96'],
	title : {
        text: '常去地点'
    },
    tooltip : {
        trigger: 'axis',
		axisPointer : { 
            type : 'shadow'
        }
    },
	
    toolbox: {
        show : true
    },
    calculable : true,
    xAxis : [
        {
            type : 'category',
            data : []
        }
    ],
    yAxis : [
        {
            type : 'value'
        }
    ],
    series : [
        {
            name:'常去地点',
            type:'bar',
            itemStyle: {
                normal: {
                    color: function(params) {
                        // build a color map as your need.
                        var colorList = [
                           '#D7504B','#C6E579','#F4E001','#F0805A','#26C0C0'
                        ];
                        return colorList[params.dataIndex]
                    },
                    label: {
                      //  show: true,
                      //  position: 'top',
                      //  formatter: '{b}\n{c}'
                    }
                }
            },
            data:[],
            markPoint : {
            }
        }
    ]
};
      chartLocSec.setOption(optionLocSec);
     </script>
	 
	 
	 
         <!--兴趣爱好 -->
    /* <script type="text/javascript">
        // 基于准备好的dom，初始化echarts实例
         var chartinst = echarts.init(document.getElementById('chartinst'));

     optioninst = {
     	title : {
        text: '兴趣爱好'
    },
    tooltip: {
        trigger: 'item',
        formatter: "{a} <br/>{b}: {c} ({d}%)"
    },
    legend: {
        orient: 'vertical',
      //  x: 'left',
      //  data:['直达','营销广告']
    },
    series: [
        {
            name:'访问来源',
            type:'pie',
            selectedMode: 'single',
            radius: [0, '30%'],

            label: {
                normal: {
                    position: 'inner'
                }
            },
            labelLine: {
                normal: {
                    show: false
                }
            },
            data:[
                {value:335, name:'游戏'}
                
            ]
        },
        {
            name:'访问来源',
            type:'pie',
            radius: ['40%', '55%'],

            data:[
                {value:335, name:'网页游戏'},
				{value:679, name:'户外探险'}
            ]
        }
    ]
};
      chartinst.setOption(optioninst);
     </script>
      <!--常去地点 -->
    <script type="text/javascript">
        // 基于准备好的dom，初始化echarts实例
        var chartloc = echarts.init(document.getElementById('chartloc'));

     optionloc = {
     	title : {
        text: '常去地点'
    },
    tooltip: {
        trigger: 'item',
        formatter: "{a} <br/>{b}: {c} ({d}%)"
    },
    legend: {
        orient: 'vertical',
      //  x: 'left',
      //  data:['直达','营销广告','搜索引擎','邮件营销','联盟广告','视频广告','百度','谷歌','必应','其他']
    },
    series: [
        {
            name:'访问来源',
            type:'pie',
            selectedMode: 'single',
            radius: [0, '30%'],

            label: {
                normal: {
                    position: 'inner'
                }
            },
            labelLine: {
                normal: {
                    show: false
                }
            },
            data:[
                {value:335, name:'直达', selected:true},
                {value:679, name:'营销广告'},
                {value:1548, name:'搜索引擎'}
            ]
        },
        {
            name:'访问来源',
            type:'pie',
            radius: ['40%', '55%'],

            data:[
                {value:335, name:'直达'},
                {value:310, name:'邮件营销'}
            ]
        }
    ]
};
      chartloc.setOption(optionloc);
     </script> */
     
          <!-- 受众-->
    <script type="text/javascript">
        var chartmap = echarts.init(document.getElementById('chartmap'), 'shine');
        function randomData() {
            //return Math.round(Math.random()*1000);
            return 0;
        }

        var optionmap = {
        title: {
            text: '受众地域分布',
            subtext: '',
            left: 'center'
        },
        tooltip: {
            trigger: 'item'
        },
        legend: {
            orient: 'vertical',
            left: 'left',
            show: false,
            data:['受众']
        },
        visualMap: {
            min: 0,
            max: 10000,
            left: 'left',
            top: 'bottom',
            text: ['高','低'],           // 文本，默认为数值文本
            calculable: true
        },
        toolbox: {
            show: false,
            orient: 'vertical',
            left: 'right',
            top: 'center',
            feature: {
                dataView: {readOnly: false},
                restore: {},
                saveAsImage: {}
            }
        },
        series: [
            {
                name: '受众',
                type: 'map',
                mapType: 'china',
                hoverAnimation: true,
                roam: false,
                label: {
                    normal: {
                        show: true
                    },
                    emphasis: {
                        show: true
                    }
                },
                data:[
                    {name: '北京',value: randomData() },
                    {name: '天津',value: randomData() },
                    {name: '上海',value: randomData() },
                    {name: '重庆',value: randomData() },
                    {name: '河北',value: randomData() },
                    {name: '河南',value: randomData() },
                    {name: '云南',value: randomData() },
                    {name: '辽宁',value: randomData() },
                    {name: '黑龙江',value: randomData() },
                    {name: '湖南',value: randomData() },
                    {name: '安徽',value: randomData() },
                    {name: '山东',value: randomData() },
                    {name: '新疆',value: randomData() },
                    {name: '江苏',value: randomData() },  
                    {name: '浙江',value: randomData() },
                    {name: '江西',value: randomData() },
                    {name: '湖北',value: randomData() },
                    {name: '广西',value: randomData() },
                    {name: '甘肃',value: randomData() },
                    {name: '山西',value: randomData() },
                    {name: '内蒙古',value: randomData() },
                    {name: '陕西',value: randomData() },
                    {name: '吉林',value: randomData() },
                    {name: '福建',value: randomData() },
                    {name: '贵州',value: randomData() },
                    {name: '广东',value: randomData() },
                    {name: '青海',value: randomData() },
                    {name: '西藏',value: randomData() },
                    {name: '四川',value: randomData() },
                    {name: '宁夏',value: randomData() },
                    {name: '海南',value: randomData() },
                    {name: '台湾',value: randomData() },
                    {name: '香港',value: randomData() },
                    {name: '澳门',value: randomData() }
                ]
            }
        ]
        };
      // 使用刚指定的配置项和数据显示图表。
      chartmap.setOption(optionmap);
     </script>
     
     <!--应用分类-->
    <script type="text/javascript">
        var chartapp = echarts.init(document.getElementById('chartapp'));
        var optionapp = {
          title : {
              text: '应用分类',
              subtext: '',
              x:'center'
          },
          tooltip : {
              trigger: 'item',
              formatter: "{a} <br/>{b} : {c} ({d}%)"
          },
          legend: {
              orient: 'vertical',
              left: 'left',
          },
          series : [
              {
                  name: 'app类别',
                  type: 'pie',
                  radius : '55%',
                  center: ['50%', '60%'],
                  data:[
                      {value:0, name:'娱乐'},
                      {value:0, name:'工具'},
                      {value:0, name:'新闻'}
                  ],
                  itemStyle: {
                      emphasis: {
                          shadowBlur: 10,
                          shadowOffsetX: 0,
                          shadowColor: 'rgba(0, 0, 0, 0.5)'
                      },
                      normal: {
                        // 阴影的大小
                        shadowBlur: 200,
                        // 阴影水平方向上的偏移
                        shadowOffsetX: 0,
                        // 阴影垂直方向上的偏移
                        shadowOffsetY: 0,
                        // 阴影颜色
                        shadowColor: 'rgba(0, 0, 0, 0.2)'
                    }
                  }
              }
          ]
      };
      chartapp.setOption(optionapp);
     </script>

</html>
